[gd_scene load_steps=20 format=3 uid="uid://b67m5mnbrjcmo"]

[ext_resource type="Script" uid="uid://dtnxd4krtryr3" path="res://scripts/agent.gd" id="1_b2pv0"]
[ext_resource type="PackedScene" uid="uid://bjpcpftxbnhw3" path="res://assets/blender/Animated/Skeleton.blend" id="2_umeaf"]
[ext_resource type="Script" uid="uid://dls0esx18alxy" path="res://scripts/AgentAnimation.gd" id="3_yc63n"]
[ext_resource type="PackedScene" uid="uid://1iydcxqvs7te" path="res://assets/blender/Div/Knife.blend" id="4_dg1j7"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_noarx"]
radius = 0.3876953
height = 1.5112305

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_nkfwj"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_lug0u"]
animation = &"Running"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_dg1j7"]
animation = &"RunningWithFood"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qeyy3"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_nkfwj"]
advance_mode = 2
advance_expression = "objectInHand != null"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_iuhnp"]
advance_mode = 2
advance_expression = "objectInHand == null"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_q3gef"]
states/Running/node = SubResource("AnimationNodeAnimation_lug0u")
states/Running/position = Vector2(564, 46)
states/RunningWithFood/node = SubResource("AnimationNodeAnimation_dg1j7")
states/RunningWithFood/position = Vector2(584, 126)
states/Start/position = Vector2(157, 83)
transitions = ["Start", "Running", SubResource("AnimationNodeStateMachineTransition_qeyy3"), "Running", "RunningWithFood", SubResource("AnimationNodeStateMachineTransition_nkfwj"), "RunningWithFood", "Running", SubResource("AnimationNodeStateMachineTransition_iuhnp")]
graph_offset = Vector2(-47, 18)

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_52ahs"]
animation = &"Cut"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_y08pw"]
animation = &"PureIdle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_q3gef"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_f14ir"]
advance_mode = 2
advance_expression = "isCutting"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_tduqk"]
advance_mode = 2
advance_expression = "not isCutting"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_tduqk"]
states/Cut/node = SubResource("AnimationNodeAnimation_52ahs")
states/Cut/position = Vector2(660, 152)
states/PureIdle/node = SubResource("AnimationNodeAnimation_y08pw")
states/PureIdle/position = Vector2(628, 49)
states/Start/position = Vector2(179, 85)
transitions = ["Start", "PureIdle", SubResource("AnimationNodeStateMachineTransition_q3gef"), "PureIdle", "Cut", SubResource("AnimationNodeStateMachineTransition_f14ir"), "Cut", "PureIdle", SubResource("AnimationNodeStateMachineTransition_tduqk")]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_nkfwj"]
graph_offset = Vector2(-731.59784, -5.0854645)
nodes/StaticStateMachine/node = SubResource("AnimationNodeStateMachine_tduqk")
nodes/StaticStateMachine/position = Vector2(-540, -40)
nodes/RunningStateMachine/node = SubResource("AnimationNodeStateMachine_q3gef")
nodes/RunningStateMachine/position = Vector2(-580, 180)
nodes/Running/node = SubResource("AnimationNodeBlend2_nkfwj")
nodes/Running/position = Vector2(-120, 80)
node_connections = [&"output", 0, &"Running", &"Running", 0, &"StaticStateMachine", &"Running", 1, &"RunningStateMachine"]

[node name="agent" type="CharacterBody3D" node_paths=PackedStringArray("nav_agent", "storePoint")]
collision_layer = 2
collision_mask = 3
script = ExtResource("1_b2pv0")
nav_agent = NodePath("feet/NavigationAgent3D")
storePoint = NodePath("grabPoint")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_noarx")

[node name="grabPoint" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.704)

[node name="feet" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.8, 0)

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="feet"]
path_desired_distance = 1.3
target_desired_distance = 2.0

[node name="Area3D" type="Area3D" parent="."]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Area3D"]
transform = Transform3D(1.05, 0, 0, 0, 1.05, 0, 0, 0, 1.05, 0, -0.030419052, 0)
shape = SubResource("CapsuleShape3D_noarx")

[node name="Skeleton" parent="." node_paths=PackedStringArray("agent", "animationTree", "knife") instance=ExtResource("2_umeaf")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.74930227, 0)
script = ExtResource("3_yc63n")
agent = NodePath("..")
animationTree = NodePath("../AnimationTree")
knife = NodePath("Armature/Skeleton3D/RightHandAttachment/Knife2")

[node name="Skeleton3D" parent="Skeleton/Armature" index="0"]
bones/0/position = Vector3(-1.7625289e-15, 0.3810462, -0.051285226)
bones/0/rotation = Quaternion(-2.9802326e-08, 1.1920928e-07, -2.5243543e-29, 1)
bones/1/position = Vector3(1.3974065e-09, 0.16516575, -0.0058611557)
bones/1/rotation = Quaternion(-3.5527137e-15, -1.19209275e-07, 1.0097419e-28, 1)
bones/2/position = Vector3(-6.2008954e-23, 0.38677543, -3.7252903e-09)
bones/2/rotation = Quaternion(-1.5300025e-10, -0.050632488, -3.0179312e-09, 0.99871737)
bones/3/position = Vector3(4.438915e-10, 0.31650287, 5.702572e-10)
bones/3/rotation = Quaternion(3.609644e-16, 1.17346644e-07, 1.514914e-16, 1)
bones/4/rotation = Quaternion(2.5737066e-07, -3.3205728e-07, 0.75885683, 0.65125746)
bones/5/rotation = Quaternion(2.6964145e-07, 2.2388423e-07, 0.6451419, 0.7640628)
bones/6/rotation = Quaternion(4.6060116e-09, -1.2731961e-07, -0.0010584729, 0.99999946)
bones/7/rotation = Quaternion(2.5737066e-07, 3.3205728e-07, -0.75885683, 0.65125746)
bones/8/rotation = Quaternion(2.6964145e-07, -2.2388423e-07, -0.6451419, 0.7640628)
bones/9/rotation = Quaternion(4.6060116e-09, 1.273196e-07, 0.0010584729, 0.99999946)
bones/10/position = Vector3(-0.17379601, 0.017536279, -0.020514134)
bones/10/rotation = Quaternion(-0.095714524, -0.00056450407, 0.99539137, 0.0058742454)
bones/11/rotation = Quaternion(0.6897524, -0.0005094288, -3.5572026e-05, 0.72404516)
bones/12/position = Vector3(0.17379601, 0.017536279, -0.020514058)
bones/12/rotation = Quaternion(0.08237847, -0.0004858002, 0.9965837, -0.0058812764)
bones/13/rotation = Quaternion(0.6897524, 0.00050942594, 3.5574547e-05, 0.72404516)

[node name="RightHandAttachment" type="BoneAttachment3D" parent="Skeleton/Armature/Skeleton3D" index="1"]
transform = Transform3D(-0.9998348, -0.01817858, 2.2991321e-07, 0.018178595, -0.99983466, -7.400446e-08, 2.3122047e-07, -6.981279e-08, 0.99999994, -0.35051513, 0.42591548, -0.038830355)
bone_name = "Hand.R"
bone_idx = 6

[node name="Knife2" parent="Skeleton/Armature/Skeleton3D/RightHandAttachment" instance=ExtResource("4_dg1j7")]
transform = Transform3D(-0.02236478, -0.99726385, -0.07048476, -0.9921898, 0.013485901, 0.124014825, -0.12272516, 0.0727076, -0.9897748, -0.052975416, 0.096066475, -0.014490679)

[node name="AnimationTree" type="AnimationTree" parent="."]
root_node = NodePath("../Skeleton")
tree_root = SubResource("AnimationNodeBlendTree_nkfwj")
advance_expression_base_node = NodePath("..")
anim_player = NodePath("../Skeleton/AnimationPlayer")
parameters/Running/blend_amount = 0.0

[editable path="Skeleton"]
